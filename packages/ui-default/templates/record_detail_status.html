<div class="section visible" id="status">
  <div class="section__header">
    <h1 class="section__title">
      <span class="icon record-status--icon {{ model.builtin.STATUS_CODES[rdoc['status']] }}"></span>
      {% if typeof(rdoc['score']) == 'number' %}
      <span style="color: {{ utils.status.getScoreColor(rdoc.score|default(0)) }}">{{ rdoc.score|default(0) }}</span>
      {% endif %}
      <span class="record-status--text {{ model.builtin.STATUS_CODES[rdoc['status']] }}">
        {{ model.builtin.STATUS_TEXTS[rdoc['status']] }}
      </span>
      {% if rdoc.progress %}{{ rdoc.progress|int }}%{% endif %}
    </h1>
  </div>
{% if rdoc.compilerTexts.length %}
  <div class="section__body">
    <pre class="compiler-text">{{ rdoc.compilerTexts|join('\n')|ansi|safe }}</pre>
  </div>
{% endif %}
{% if rdoc.judgeTexts.length %}
  <div class="section__body">
    <pre class="judge-text">{{ formatJudgeTexts(rdoc.judgeTexts)|ansi|safe }}</pre>
  </div>
{% endif %}
{% if rdoc.testCases.length %} 
  <div class="section__body no-padding">
    <div>
      {% set singleSubtask = rdoc.testCases|groupby('subtaskId')|length === 1 %}
      {%- for subtaskId, rcdocs in rdoc.testCases|sort(false,false,_key)|groupby('subtaskId') -%}
        <div class="subtask" data-subtask-id="{{subtaskId}}">
          {% if not singleSubtask %}
          <div class="subtask-line">
            <div class="cell">
              {{ _('Subtask {0}').format(subtaskId|int|default(1))}}
            </div>
            {% if rdoc.subtasks %}
            <div class="cell">
              <span class="icon record-status--icon {{ model.builtin.STATUS_CODES[rdoc.subtasks[subtaskId]['status']] }}"></span>
              <span class="record-status--text {{ model.builtin.STATUS_CODES[rdoc.subtasks[subtaskId]['status']] }}">
                {{ model.builtin.STATUS_TEXTS[rdoc.subtasks[subtaskId]['status']] }}
              </span>
            </div>
            <div class="cell record-status--text {{ model.builtin.STATUS_CODES[rdoc.subtasks[subtaskId]['status']] }}">
              {{ rdoc.subtasks[subtaskId]['score']|default(0)|round(3) }} pt
            </div>
            {% endif %}
          </div>
          {% endif %}
        {%- for rcdoc in rcdocs|sort(false,false,'id') -%}
          <div class="case record-status--border {{ model.builtin.STATUS_CODES[rcdoc['status']] }}" data-case-id="{{rcdoc.id|default(loop.index)}}">
            <div class="case-line">
              <div class="cell">
                <span class="expand-icon">
                  <span class="icon icon-expand_more"></span>
                </span>
                <span>{{ _('Test {0}').format(rcdoc.id|default(loop.index)) }}</span>
              </div>
              <div class="cell">
                <span class="icon record-status--icon {{ model.builtin.STATUS_CODES[rcdoc['status']] }}"></span>
                <span class="record-status--text {{ model.builtin.STATUS_CODES[rcdoc['status']] }}">
                  {{ model.builtin.STATUS_TEXTS[rcdoc['status']] }}
                </span>
              </div>
              <div class="cell record-status--text {{ model.builtin.STATUS_CODES[(rdoc.subtasks[subtaskId]['status'] if _key != 'id' else rcdoc.status)] }}">
                {% if typeof(rcdoc.scaledScore) !== "undefined" %}
                  {{ (rcdoc.scaledScore*100)|round(3) }}% pt
                {% else %}
                  {{ (rcdoc.score)|default(0)}} pt
                {% endif %}
              </div>
              <div class="cell">
                {% if rcdoc['status'] == STATUS.STATUS_TIME_LIMIT_EXCEEDED or rcdoc['status'] == STATUS.STATUS_MEMORY_LIMIT_EXCEEDED or rcdoc['status'] == STATUS.STATUS_OUTPUT_LIMIT_EXCEEDED %}&ge;{% endif %}{{ rcdoc.time|round|int }} ms
              </div>
              <div class="cell">
                {% if rcdoc['status'] == STATUS.STATUS_TIME_LIMIT_EXCEEDED or rcdoc['status'] == STATUS.STATUS_MEMORY_LIMIT_EXCEEDED or rcdoc['status'] == STATUS.STATUS_OUTPUT_LIMIT_EXCEEDED %}&ge;{% endif %}{{ size(rcdoc.memory, 1024) }}
              </div>
            </div>
            <div class="details">
              <h3 class="section__title">
                {{ _('Checker Message') }}
              </h3>
              <div>
                <pre>{{ formatJudgeTexts([rcdoc.message]) if rcdoc.message else _('No message') }}</pre>
              </div>
              {% if rcdoc.traceStack %}
              <h3 class="section__title">
                {{ _('Trace Stack') }}
              </h3>
              <p>
                {{ _('A read error occurred on stream `{0}`.').format(rcdoc.traceStack.streamName) }}
              </p>
              <table class="data-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>{{ _('Var name') }}</th>
                    <th>{{ _('Line') }}</th>
                    <th>{{ _('Col') }}</th>
                    <th>{{ _('Byte') }}</th>
                  </tr>
                </thead>
                <tbody>
                  {%- for trace in rcdoc.traceStack.stack|reverse -%}
                  <tr>
                    <td>{{ loop.index0 }}</td>
                    <td>{{ trace.varName }}</td>
                    <td>{{ trace.lineNum+1 }}</td>
                    <td>{{ trace.colNum+1 }}</td>
                    <td>{{ trace.byteNum+1 }}</td>
                  </tr>
                  {%- endfor -%}
                </tbody>
              </table>
              {% endif %}
              {% for stream, titleStr in [
                  ['inf', 'Input File'],
                  ['ouf', 'Output File'],
                  ['ans', 'Answer File'],
                  ['fromUser', 'User Output'],
                  ['toUser', 'Interactor Output']] %}
                {% if rcdoc[stream] %}
                <h3 class="section__title">
                  {{ _(titleStr) }}
                </h3>
                <div>
                  <textarea readonly data-editor
                    data-stream-name="{{ stream }}"
                    data-ignored-lines-begin={{ rcdoc[stream].ignoredLinesBegin }}
                    data-ignored-lines-end={{ rcdoc[stream].ignoredLinesEnd }}
                    data-ignored-bytes-begin={{ rcdoc[stream].ignoredBytesBegin }}
                    data-ignored-bytes-end={{ rcdoc[stream].ignoredBytesEnd }}
                    data-first-line-ignored-bytes-begin={{ rcdoc[stream].firstLineIgnoredBytesBegin }}
                    data-last-line-ignored-bytes-end={{ rcdoc[stream].lastLineIgnoredBytesEnd }}
                    {% if rcdoc.traceStack.streamName === stream and rcdoc.traceStack.stack|length %}
                      {% set _trace = rcdoc.traceStack.stack|last %}
                      data-error-line={{ _trace.lineNum }}
                      data-error-col={{ _trace.colNum }}
                      data-error-msg="{{ _('Error reading variable `{0}` at byte {1}: {2}').format(_trace.varName, _trace.byteNum+1, formatJudgeTexts([rcdoc.message|default('')])) | escape }}"
                    {% endif %}
                    >{{ rcdoc[stream].content }}</textarea>
                  <div class="monaco-target"></div>
                </div>
                {% endif %}
              {% endfor %}
            </div>
          </div>
        {%- endfor -%}
        </div>
      {%- endfor -%}
    </div>
  </div>
{% endif %}
</div>
