{% extends "layout/immersive.html" %}
{% block content %}
<div class="row"><div class="columns">
  <div class="immersive--content immersive--center">
    <h1>{{ _('Confirm Access') }}</h1>
    <form method="POST">
      {% if UserContext.authn %}
      <div class="row"><div class="columns">
        <input type="hidden" name="authnChallenge" value="">
        <button class="inverse expanded rounded primary button" name="webauthn_verify" data-type="sudo" autofocus>{{ _('Use Authenticator To Confirm') }}</button>
      </div></div>
      {% endif %}
      {% if UserContext.tfa %}
      <div class="row" id="tfa_div"><div class="columns">
        <label class="inverse material textbox">
          {{ _('Two Factor Authentication Code') }}
          <input name="tfa" type="number">
        </label>
        <div class="text-center">
          <input type="submit" value="{{ _('Use TFA Code To Confirm') }}" class="inverse expanded rounded primary button">
        </div>
      </div></div>
      {% endif %}
      <div class="row"><div class="columns">
        <label class="inverse material textbox">
          {{ _('Password') }}
          <input name="password" type="password"{% if not UserContext.authn %} autofocus{% endif %}>
        </label>
      </div></div>
      <div class="row"><div class="columns">
        <div class="text-center">
          <input type="submit" value="{{ _('Use Password To Confirm') }}" class="inverse expanded rounded primary button">
        </div>
      </div></div>
      <div class="row"><div class="columns">
        <div class="text-center supplementary inverse">
          <p><strong>Tip:</strong> You are entering <a href="https://docs.github.com/articles/sudo-mode">sudo mode</a>.</p>
          <p>After you've performed a sudo-protected action, you'll only be asked to re-authenticate again after a few hours of inactivity.</p>
        </div>
      </div></div>
    </form>
  </div>
</div></div>
{% endblock %}
